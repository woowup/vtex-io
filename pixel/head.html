<script type="text/javascript" id="wu-tracking-script">
    (function() {
      const webtrackingIsEnabled = "{{settings.allowWupWebTracking}}";
      const publicKey = "{{settings.wu-PublicKey}}";
      if (!publicKey) {
        console.warn('Warning: No WOOWUP PUBLIC KEY is defined. Please configure it in the apps admin.');
        return;
      }
  
      if (!webtrackingIsEnabled || webtrackingIsEnabled === 'false') {
        console.warn('Warning: WoowUp Webtracking is not enabled. Please configure it in the apps admin.');
        return;
      }
  
      var script = document.createElement("script");
      var parent = document.getElementById("wu-tracking-script").parentNode;
      var date = (new Date()).toISOString().split('T')[0];
      script.src = "https://assets-cdn.woowup.com/js/webtracking.min.js?v=" + date;
      script.addEventListener('load', () => {
        console.info("WoowUp Webtracking Script loaded")
        window.trackProductViewEvent = function (metadata) {
          if (publicKey && webtrackingIsEnabled && webtrackingIsEnabled !== "false") {
            WU.track(publicKey, 'product-view', metadata);
          }
        }
      });
      parent.appendChild(script);

    })()
  </script>
