<script src="https://assets-cdn.woowup.com/js/webtracking.min.js" type="text/javascript"></script>
<script type="text/javascript" id="wu-tracking-script">
  (function() {
    window.trackProductViewEvent = _trackProductViewEvent;
    const webtrackingIsEnabled = "{{settings.allowWupWebTracking}}";
    const publicKey = "{{settings.wu-PublicKey}}";
    if (!publicKey) {
      console.warn('Warning: No WOOWUP PUBLIC KEY is defined. Please configure it in the apps admin.');
      return;
    }
    if (!webtrackingIsEnabled) {
      console.warn('Warning: WoowUp Webtracking is not enabled. Please configure it in the apps admin.');
      return;
    }

    var script=document.createElement("script");
    var parent=document.getElementById("wu-tracking-script").parentNode;
    var date = (new Date()).toISOString().split('T')[0];
    script.src="https://assets-cdn.woowup.com/js/webtracking.min.js?v="+date;
    script.addEventListener('load', () => {
      console.info("WoowUp Webtracking Script loaded")
    });
    parent.appendChild(script);

    function _trackProductViewEvent(metadata) {
      if (publicKey && webtrackingIsEnabled) {
        WU.track(publicKey, 'product-view', metadata);
      }
    }
  })()
</script>
<script id="wu-push-script">
  (function() {
    const pushIsEnabled = "{{settings.allowWupPushNotifications}}"
    if (!pushIsEnabled) {
      console.warn('Warning: WoowUp Push Notifications is not enabled. Please configure it in the apps admin.');
      return;
    }
    const publicKey = "{{settings.wu-PublicKey}}";
    const instanceId = "{{settings.wu-InstanceId}}";
    if (!publicKey) {
      console.warn('Warning: No WOOWUP PUBLIC KEY is defined. Please configure it in the apps admin.');
      return;
    }

    if (!instanceId) {
      console.warn('Warning: No WOOWUP INSTANCE ID is defined. Please configure it in the apps admin.');
      return;
    }

    var script=document.createElement("script");
    var parent=document.getElementById("wu-push-script").parentNode;
    var date = (new Date()).toISOString().split('T')[0];
    script.src="https://assets-cdn.woowup.com/js/push-notifications.min.js?v="+date;
    script.addEventListener('load', () => {
        WU.pushNotifications(publicKey, instanceId);
    });
    parent.appendChild(script);

  })()
</script>